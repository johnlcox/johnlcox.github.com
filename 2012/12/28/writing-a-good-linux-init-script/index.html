<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Writing a Good Linux Init Script | John Leacox</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="A good Linux init script that works across multiple distros is hard to find.  Most distros have a sample/skeleton init script to base your own init scripts on, but that requires having a separate init">
<meta property="og:type" content="article">
<meta property="og:title" content="Writing a Good Linux Init Script">
<meta property="og:url" content="http://john.leacox.com/2012/12/28/writing-a-good-linux-init-script/index.html">
<meta property="og:site_name" content="John Leacox">
<meta property="og:description" content="A good Linux init script that works across multiple distros is hard to find.  Most distros have a sample/skeleton init script to base your own init scripts on, but that requires having a separate init">
<meta property="og:updated_time" content="2016-07-10T22:40:50.326Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Writing a Good Linux Init Script">
<meta name="twitter:description" content="A good Linux init script that works across multiple distros is hard to find.  Most distros have a sample/skeleton init script to base your own init scripts on, but that requires having a separate init">
<meta name="twitter:creator" content="@johnlcox">
  
    <link rel="alternative" href="/atom.xml" title="John Leacox" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
    <link href="http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700|Ubuntu:400,700,400italic" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36983897-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">John Leacox</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        <a id="nav-github-link" class="nav-icon" href="https://github.com/johnlcox" target="_blank"></a>
        <a id="nav-linkedin-link" class="nav-icon" href="https://www.linkedin.com/in/johnlcox" target="_blank"></a>
        <a id="nav-twitter-link" class="nav-icon" href="https://twitter.com/johnlcox" target="_blank"></a>
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://john.leacox.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-writing-a-good-linux-init-script" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/12/28/writing-a-good-linux-init-script/" class="article-date">
  <time datetime="2012-12-28T22:18:45.000Z" itemprop="datePublished">2012-12-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Writing a Good Linux Init Script
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>A good Linux init script that works across multiple distros is hard to find.  Most distros have a sample/skeleton init script to base your own init scripts on, but that requires having a separate init script for each distro.  For the <a href="http://www.stackify.com" target="_blank" rel="external">Stackify</a> Linux agent I wanted to have  a single init script that would work on all common Linux distros.  I had a decent init script that worked pretty well for ‘start’ and ‘stop’ commands, but not so much for ‘status’.  The ‘status’ command worked on my development machine (<a href="http://www.ubuntu.com" target="_blank" rel="external">Ubuntu</a>) but didn’t work on the other distros I was testing on (<a href="http://www.centos.org/" target="_blank" rel="external">CentOS</a>/<a href="http://www.redhat.com/" target="_blank" rel="external">Redhat</a>/<a href="https://aws.amazon.com/amis?platform=Amazon+Linux&amp;selection=platform" target="_blank" rel="external">Amazon</a>).</p>
<p>Since one of the things the Stackify Linux agent does is provide information on the different installed services and their statuses, it is important that the status of our own service is correct.  As we prepare for the first beta release of the Linux agent, I decided it was time to rewrite the init script.  I started with some Google searches on how to create a cross-distro init script, but they mostly led me back to the skeleton init scripts.  While having lunch with a former coworker at <a href="http://www.fuzzystacoshop.com/" target="_blank" rel="external">Fuzzy’s Taco Shop</a> – which I highly recommend – we got to discussing init scripts and he mentioned seeing an “init script to rule them all.”</p>
<p>After lunch, I promptly searched for this legendary script.  My search lead me to the <a href="http://blog.rimuhosting.com/2009/09/30/one-java-init-script/" target="_blank" rel="external">One Java init script to rule them all</a>, which is an init script for Java application servers (e.g. Tomcat and JBoss) that will work on most Linux distros.  Turns out this script was really close to what I needed since the Stackify Linux agent is a Java application.  Many Linux distros have started implementing the <a href="http://en.wikipedia.org/wiki/Linux_Standard_Base" target="_blank" rel="external">Linux Standard Base</a> (LSB) which provides logging methods and a standard way to implement init script statuses.  However, since not all versions support LSB, I cannot use those logging methods for my init script.</p>
<p>The nice thing about the Java init script to rule them all is that it checks for the existence of the LSB methods and if they do not exist it provides its own implementation.  I was able to base the Stackify agent init script largely on this existing script.  The script now works on all of the distros previously mentioned and should also work on most other distros.  The status returns the correct status on these distros and returns the correct status code for systems that do support LSB.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://john.leacox.com/2012/12/28/writing-a-good-linux-init-script/" data-id="ciqkuzwzh0003u6jxrnbzv19b" class="article-share-link">Share</a>
      
        <a href="http://john.leacox.com/2012/12/28/writing-a-good-linux-init-script/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/">shell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/stackify/">stackify</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2013/01/07/drumming-as-exercise-routine/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Drumming as Exercise Routine
        
      </div>
    </a>
  
  
    <a href="/2012/12/27/my-favorite-music-of-2012/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">My Favorite Music of 2012</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/10/26/staying-motivated-on-side-projects/">Staying Motivated on Side Projects</a>
          </li>
        
          <li>
            <a href="/2015/08/13/implementing-scala-like-pattern-matching-in-java-8/">Implementing Scala-like Pattern Matching in Java 8</a>
          </li>
        
          <li>
            <a href="/2013/02/11/a-safer-way-to-create-java-subprocesses/">A Safer Way To Create Java Subprocesses</a>
          </li>
        
          <li>
            <a href="/2013/01/17/differentiate-java-processes-by-working-directory/">Differentiate Java Processes by Working Directory</a>
          </li>
        
          <li>
            <a href="/2013/01/07/drumming-as-exercise-routine/">Drumming as Exercise Routine</a>
          </li>
        
          <li>
            <a href="/2012/12/28/writing-a-good-linux-init-script/">Writing a Good Linux Init Script</a>
          </li>
        
          <li>
            <a href="/2012/12/27/my-favorite-music-of-2012/">My Favorite Music of 2012</a>
          </li>
        
          <li>
            <a href="/2012/12/14/blogging-is-hard/">Blogging is Hard</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/blogging/">blogging</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/drums/">drums</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exercise/">exercise</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geolode/">geolode</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda-expressions/">lambda expressions</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lodeup/">lodeup</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/motivation/">motivation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/music/">music</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pattern-matching/">pattern matching</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/running/">running</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala/">scala</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stackify/">stackify</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/blogging/" style="font-size: 10px;">blogging</a> <a href="/tags/drums/" style="font-size: 10px;">drums</a> <a href="/tags/exercise/" style="font-size: 10px;">exercise</a> <a href="/tags/geolode/" style="font-size: 10px;">geolode</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/lambda-expressions/" style="font-size: 10px;">lambda expressions</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/lodeup/" style="font-size: 10px;">lodeup</a> <a href="/tags/motivation/" style="font-size: 10px;">motivation</a> <a href="/tags/music/" style="font-size: 10px;">music</a> <a href="/tags/pattern-matching/" style="font-size: 10px;">pattern matching</a> <a href="/tags/running/" style="font-size: 10px;">running</a> <a href="/tags/scala/" style="font-size: 10px;">scala</a> <a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/stackify/" style="font-size: 15px;">stackify</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">February 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">December 2012</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 John Leacox<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'johnlcox';
  
  var disqus_url = 'http://john.leacox.com/2012/12/28/writing-a-good-linux-init-script/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<div id="scroll2top" style="position:fixed;bottom:150px;right:50px;cursor: pointer;Z-index:9999">
<a title="返回顶部" href="#"><img src="/scroll2top/scrollup.png"/></a>
</div>
<script src="/scroll2top/scroll2top.js"></script>



  </div>
</body>
</html>