<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Writing a Good Linux Init Script | John Leacox</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="A good Linux init script that works across multiple distros is hard to find.  Most distros have a sample/skeleton init script to base your own init scripts on, but that requires having a separate init">
<meta property="og:type" content="article">
<meta property="og:title" content="Writing a Good Linux Init Script">
<meta property="og:url" content="http://johnlcox.github.com/2012/12/28/2012-12-28-writing-a-good-linux-init-script/index.html">
<meta property="og:site_name" content="John Leacox">
<meta property="og:description" content="A good Linux init script that works across multiple distros is hard to find.  Most distros have a sample/skeleton init script to base your own init scripts on, but that requires having a separate init">
<meta property="og:updated_time" content="2016-07-10T22:40:50.326Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Writing a Good Linux Init Script">
<meta name="twitter:description" content="A good Linux init script that works across multiple distros is hard to find.  Most distros have a sample/skeleton init script to base your own init scripts on, but that requires having a separate init">
<meta name="twitter:creator" content="@johnlcox">
  
    <link rel="alternate" href="/atom.xml" title="John Leacox" type="application/atom+xml">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" integrity="sha384-XdYbMnZ/QjLh6iI4ogqCTaIjrFk87ip+ekIjefZch0Y+PvJ8CDYtEs1ipDmPorQ+" crossorigin="anonymous">

  <link rel="stylesheet" href="/css/styles.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-36983897-3', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <nav class="navbar navbar-inverse">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="main-menu-navbar">
      <ul class="nav navbar-nav">
        
          <li><a class=""
                 href="/index.html">Home</a></li>
        
          <li><a class=""
                 href="/archives/">Archives</a></li>
        
      </ul>

      <!--
      <ul class="nav navbar-nav navbar-right">
        
          <li><a href="/atom.xml" title="RSS Feed"><i class="fa fa-rss"></i></a></li>
        
      </ul>
      -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

  <div class="container">
    <div class="blog-header">
  <h1 class="blog-title">John Leacox</h1>
  
</div>

    <div class="row">
        <div class="col-sm-8 blog-main">
          <article id="post-2012-12-28-writing-a-good-linux-init-script" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 class="article-title" itemprop="name">
      Writing a Good Linux Init Script
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2012/12/28/2012-12-28-writing-a-good-linux-init-script/" class="article-date"><time datetime="2012-12-28T22:18:45.000Z" itemprop="datePublished">2012-12-28</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>A good Linux init script that works across multiple distros is hard to find.  Most distros have a sample/skeleton init script to base your own init scripts on, but that requires having a separate init script for each distro.  For the <a href="http://www.stackify.com" target="_blank" rel="external">Stackify</a> Linux agent I wanted to have  a single init script that would work on all common Linux distros.  I had a decent init script that worked pretty well for ‘start’ and ‘stop’ commands, but not so much for ‘status’.  The ‘status’ command worked on my development machine (<a href="http://www.ubuntu.com" target="_blank" rel="external">Ubuntu</a>) but didn’t work on the other distros I was testing on (<a href="http://www.centos.org/" target="_blank" rel="external">CentOS</a>/<a href="http://www.redhat.com/" target="_blank" rel="external">Redhat</a>/<a href="https://aws.amazon.com/amis?platform=Amazon+Linux&amp;selection=platform" target="_blank" rel="external">Amazon</a>).</p>
<p>Since one of the things the Stackify Linux agent does is provide information on the different installed services and their statuses, it is important that the status of our own service is correct.  As we prepare for the first beta release of the Linux agent, I decided it was time to rewrite the init script.  I started with some Google searches on how to create a cross-distro init script, but they mostly led me back to the skeleton init scripts.  While having lunch with a former coworker at <a href="http://www.fuzzystacoshop.com/" target="_blank" rel="external">Fuzzy’s Taco Shop</a> – which I highly recommend – we got to discussing init scripts and he mentioned seeing an “init script to rule them all.”</p>
<p>After lunch, I promptly searched for this legendary script.  My search lead me to the <a href="http://blog.rimuhosting.com/2009/09/30/one-java-init-script/" target="_blank" rel="external">One Java init script to rule them all</a>, which is an init script for Java application servers (e.g. Tomcat and JBoss) that will work on most Linux distros.  Turns out this script was really close to what I needed since the Stackify Linux agent is a Java application.  Many Linux distros have started implementing the <a href="http://en.wikipedia.org/wiki/Linux_Standard_Base" target="_blank" rel="external">Linux Standard Base</a> (LSB) which provides logging methods and a standard way to implement init script statuses.  However, since not all versions support LSB, I cannot use those logging methods for my init script.</p>
<p>The nice thing about the Java init script to rule them all is that it checks for the existence of the LSB methods and if they do not exist it provides its own implementation.  I was able to base the Stackify agent init script largely on this existing script.  The script now works on all of the distros previously mentioned and should also work on most other distros.  The status returns the correct status on these distros and returns the correct status code for systems that do support LSB.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://johnlcox.github.com/2012/12/28/2012-12-28-writing-a-good-linux-init-script/" data-id="ciqh7esiy0003f0jx03mk0s8x" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://johnlcox.github.com/2012/12/28/2012-12-28-writing-a-good-linux-init-script/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/">shell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/stackify/">stackify</a></li></ul>


    </footer>
  </div>
  
    
<ul id="article-nav" class="nav nav-pills nav-justified">
  
  <li role="presentation">
    <a href="/2012/12/27/2012-12-27-my-favorite-music-of-2012/" id="article-nav-older" class="article-nav-link-wrap">
      <i class="fa fa-chevron-left pull-left"></i>
      <span class="article-nav-link-title">My Favorite Music of 2012</span>
    </a>
  </li>
  
  
  <li role="presentation">
    <a href="/2013/01/07/2013-01-07-drumming-as-exercise-routine/" id="article-nav-newer" class="article-nav-link-wrap">
      <span class="article-nav-link-title">Drumming as Exercise Routine</span>
      <i class="fa fa-chevron-right pull-right"></i>
    </a>
  </li>
  
</ul>


  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>



        </div>
        <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
          
  
  <div class="sidebar-module">
    <h4>Recents</h4>
    <ul class="sidebar-module-list">
      
        <li>
          <a href="/2015/10/26/2015-10-25-staying-motivated-on-side-projects/">Staying Motivated on Side Projects</a>
        </li>
      
        <li>
          <a href="/2015/08/13/2015-08-06-implementing-scala-like-pattern-matching-in-java-8/">Implementing Scala-like Pattern Matching in Java 8</a>
        </li>
      
        <li>
          <a href="/2013/02/11/2013-02-11-a-safer-way-to-create-java-subprocesses/">A Safer Way To Create Java Subprocesses</a>
        </li>
      
        <li>
          <a href="/2013/01/17/2013-02-07-differentiate-java-processes-by-working-directory/">Differentiate Java Processes by Working Directory</a>
        </li>
      
        <li>
          <a href="/2013/01/07/2013-01-07-drumming-as-exercise-routine/">Drumming as Exercise Routine</a>
        </li>
      
    </ul>
  </div>


  
  <div class="sidebar-module">
    <h4>Tags</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/blogging/">blogging</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/drums/">drums</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/exercise/">exercise</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/geolode/">geolode</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/java/">java</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/lambda-expressions/">lambda expressions</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/linux/">linux</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/lodeup/">lodeup</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/motivation/">motivation</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/music/">music</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/pattern-matching/">pattern matching</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/running/">running</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/scala/">scala</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/shell/">shell</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/stackify/">stackify</a><span class="sidebar-module-list-count">2</span></li></ul>
  </div>



  
  <div class="sidebar-module">
    <h4>Tag Cloud</h4>
    <p class="tagcloud">
      <a href="/tags/blogging/" style="font-size: 10px;">blogging</a> <a href="/tags/drums/" style="font-size: 10px;">drums</a> <a href="/tags/exercise/" style="font-size: 10px;">exercise</a> <a href="/tags/geolode/" style="font-size: 10px;">geolode</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/lambda-expressions/" style="font-size: 10px;">lambda expressions</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/lodeup/" style="font-size: 10px;">lodeup</a> <a href="/tags/motivation/" style="font-size: 10px;">motivation</a> <a href="/tags/music/" style="font-size: 10px;">music</a> <a href="/tags/pattern-matching/" style="font-size: 10px;">pattern matching</a> <a href="/tags/running/" style="font-size: 10px;">running</a> <a href="/tags/scala/" style="font-size: 10px;">scala</a> <a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/stackify/" style="font-size: 15px;">stackify</a>
    </p>
  </div>


  
  <div class="sidebar-module">
    <h4>Archives</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/10/">October 2015</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/08/">August 2015</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/02/">February 2013</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/01/">January 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2012/12/">December 2012</a><span class="sidebar-module-list-count">3</span></li></ul>
  </div>




        </div>
    </div>
  </div>
  <footer class="blog-footer">
  <div class="container">
    <div id="footer-info" class="inner">
      &copy; 2016 John Leacox<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

  
<script>
  var disqus_shortname = 'johnlcox';
  
  var disqus_url = 'http://johnlcox.github.com/2012/12/28/2012-12-28-writing-a-good-linux-init-script/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>

</body>
</html>
